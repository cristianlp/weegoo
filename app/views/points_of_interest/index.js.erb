<% if params[:show_as] == "List" %>
  
  $('ul#points_of_interest_list').append('<%= escape_javascript render(:partial => "points_of_interest/point_of_interest", :collection => @points_of_interest) %>');
  
<% else %>
  
  <% @points_of_interest.each do |point_of_interest| %>
    
    latlng = new google.maps.LatLng("<%= point_of_interest.latitude %>", "<%= point_of_interest.longitude %>");
    marker_<%= point_of_interest.id %> = create_marker(latlng, false);
    add_marker_to_map(map, marker_<%= point_of_interest.id %>);
    
    info_window_<%= point_of_interest.id %> = create_info_window('<%= escape_javascript(render :partial => "points_of_interest/info_window", :locals => { :point_of_interest => point_of_interest }) %>');
    
    open_info_window_on_click(marker_<%= point_of_interest.id %>, info_window_<%= point_of_interest.id %>);
    
  <% end %>
  
<% end %>

$('#pagination').replaceWith('<%= escape_javascript paginate(@points_of_interest, :remote => true).to_s %>');